Option Explicit

Sub DiffDebitCredit()
    Application.ScreenUpdating = False
    Dim slipNum As Long: slipNum = Cells(2, 2).Value
    Dim karikata As Long: karikata = 0
    Dim kashikata As Long: kashikata = 0

    Dim i As Long: i = 2
    
    If Cells(i, 9) <> 0 Then
        karikata = karikata + Cells(i, 9).Value
    Else
        kashikata = kashikata + Cells(i, 15).Value
        
    End If
    i = i + 1
    
    Dim diffList As Collection
    Set diffList = New Collection
    
    While Cells(i, 2).Value <> ""
        If Cells(i, 2).Value <> slipNum Then
            If karikata <> kashikata Then
                Call diffList.Add(slipNum)
                With Cells(i - 1, 2).Interior
                    .Pattern = xlSolid
                    .PatternColorIndex = xlAutomatic
                    .ThemeColor = xlThemeColorAccent1
                    .TintAndShade = 0
                    .PatternTintAndShade = 0
                End With
            End If
            karikata = 0
            kashikata = 0
            
            If Cells(i, 9) <> 0 Then
                karikata = karikata + Cells(i, 9).Value
            Else
                kashikata = kashikata + Cells(i, 15).Value
            End If
        Else
            If Cells(i, 9) <> 0 Then
                karikata = karikata + Cells(i, 9).Value
            Else
                kashikata = kashikata + Cells(i, 15).Value
            End If
        End If
        
        slipNum = Cells(i, 2).Value
        i = i + 1
    Wend
    
    Application.ScreenUpdating = True
    
    Dim diffMessage As String
    Dim e As Variant
    For Each e In diffList
        diffMessage = diffMessage & e & " "
    Next
    
    MsgBox "貸借が不一致している仕訳番号：" & diffMessage
    
End Sub